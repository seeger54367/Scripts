#!/bin/bash
ymlResume="resume.yml"
mdResume="resume.md"
pdfResume="finished_resume.pdf"

[[ -e "${mdResume}" ]] && truncate -s0 "${mdResume}"

addEmployment () {
echo -e "## Employment\n" >> "${mdResume}"
yq e '.Employment[] | "## "+ .Position +" - "+ .Company +" "+ .Start +"-"+ .End +"<CR>"+ .Tasks' "${ymlResume}" >> "${mdResume}"
}

addProjects() {
  echo -e "## Projects\n" >> "${mdResume}"
  yq e '.Projects[] | "## "+ .Name + "<CR>" + .Summary' "${ymlResume}" >> "${mdResume}"
}

main () {
  yq e '"# " + .Name +"<CR>"' "${ymlResume}" >> "${mdResume}"
  addEmployment
  addProjects
  sed -E "s/<CR>/\n\n/" -i.bak "${mdResume}"
  pandoc -V geometry:margin=1in -o "${pdfResume}" -t latex "${mdResume}"
}

main

